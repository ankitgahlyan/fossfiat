"use strict";(self.webpackChunkmytonwallet=self.webpackChunkmytonwallet||[]).push([[76],{13648:(e,t,n)=>{n.d(t,{LocalTracer:()=>a});let r=0;const o=[];class a{constructor(e,t){this.type=e,this.context=t}trace(e,t){(({type:e,message:t,data:n,context:a})=>{const i={type:e,id:String(++r),date:new Date};t&&(i.message=t),n&&(i.data=n),a&&(i.context=a),function(e){for(let t=0;t<o.length;t++)try{o[t](e)}catch(e){console.error(e)}}(i)})({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new a(e,this.context)}withContext(e){return new a(this.type,e)}withUpdatedContext(e){return new a(this.type,Object.assign(Object.assign({},this.context),e))}}"undefined"!=typeof window&&(window.__ledgerLogsListen=e=>(o.push(e),()=>{const t=o.indexOf(e);-1!==t&&(o[t]=o[o.length-1],o.pop())}))},24450:(e,t,n)=>{n.d(t,{StatusCodes:()=>u,TransportError:()=>d,TransportRaceCondition:()=>s,TransportStatusError:()=>E});const r={},o={},a=(e,t)=>{o[e]=t},i=e=>{class t extends Error{constructor(n,r,o){if(super(n||e,o),Object.setPrototypeOf(this,t.prototype),this.name=e,r)for(const e in r)this[e]=r[e];if(o&&"object"==typeof o&&"cause"in o&&!("cause"in this)){const e=o.cause;this.cause=e,"stack"in e&&(this.stack=this.stack+"\nCAUSE: "+e.stack)}}}return r[e]=t,t};i("AccountNameRequired"),i("AccountNotSupported"),i("AccountAwaitingSendPendingOperations"),i("AmountRequired"),i("BluetoothRequired"),i("BtcUnmatchedApp"),i("CantOpenDevice"),i("CashAddrNotSupported"),i("ClaimRewardsFeesWarning"),i("CurrencyNotSupported"),i("DeviceAppVerifyNotSupported"),i("DeviceGenuineSocketEarlyClose"),i("DeviceNotGenuine"),i("DeviceOnDashboardExpected"),i("DeviceOnDashboardUnexpected"),i("DeviceInOSUExpected"),i("DeviceHalted"),i("DeviceNameInvalid"),i("DeviceSocketFail"),i("DeviceSocketNoBulkStatus"),i("DeviceSocketNoBulkStatus"),i("UnresponsiveDeviceError"),i("DisconnectedDevice"),i("DisconnectedDeviceDuringOperation"),i("DeviceExtractOnboardingStateError"),i("DeviceOnboardingStatePollingError"),i("EnpointConfig"),i("EthAppPleaseEnableContractData"),i("FeeEstimationFailed"),i("FirmwareNotRecognized"),i("HardResetFail"),i("InvalidXRPTag"),i("InvalidAddress"),i("InvalidNonce"),i("InvalidAddressBecauseDestinationIsAlsoSource"),i("LatestMCUInstalledError"),i("UnknownMCU"),i("LedgerAPIError"),i("LedgerAPIErrorWithMessage"),i("LedgerAPINotAvailable"),i("ManagerAppAlreadyInstalled"),i("ManagerAppRelyOnBTC"),i("ManagerAppDepInstallRequired"),i("ManagerAppDepUninstallRequired"),i("ManagerDeviceLocked"),i("ManagerFirmwareNotEnoughSpace"),i("ManagerNotEnoughSpace"),i("ManagerUninstallBTCDep"),i("NetworkDown"),i("NetworkError"),i("NoAddressesFound"),i("NotEnoughBalance"),i("NotEnoughBalanceSwap"),i("NotEnoughBalanceToDelegate"),i("NotEnoughBalanceInParentAccount"),i("NotEnoughSpendableBalance"),i("NotEnoughBalanceBecauseDestinationNotCreated"),i("NoAccessToCamera"),i("NotEnoughGas"),i("NotEnoughGasSwap"),i("TronEmptyAccount"),i("MaybeKeepTronAccountAlive"),i("NotSupportedLegacyAddress"),i("GasLessThanEstimate"),i("PriorityFeeTooLow"),i("PriorityFeeTooHigh"),i("PriorityFeeHigherThanMaxFee"),i("MaxFeeTooLow"),i("PasswordsDontMatch"),i("PasswordIncorrect"),i("RecommendSubAccountsToEmpty"),i("RecommendUndelegation"),i("TimeoutTagged"),i("UnexpectedBootloader"),i("MCUNotGenuineToDashboard"),i("RecipientRequired"),i("UnavailableTezosOriginatedAccountReceive"),i("UnavailableTezosOriginatedAccountSend"),i("UpdateFetchFileFail"),i("UpdateIncorrectHash"),i("UpdateIncorrectSig"),i("UpdateYourApp"),i("UserRefusedDeviceNameChange"),i("UserRefusedAddress"),i("UserRefusedFirmwareUpdate"),i("UserRefusedAllowManager"),i("UserRefusedOnDevice"),i("PinNotSet"),i("ExpertModeRequired"),i("TransportOpenUserCancelled"),i("TransportInterfaceNotAvailable");const s=i("TransportRaceCondition");var c;i("TransportWebUSBGestureRequired"),i("TransactionHasBeenValidatedError"),i("TransportExchangeTimeoutError"),i("DeviceShouldStayInApp"),i("WebsocketConnectionError"),i("WebsocketConnectionFailed"),i("WrongDeviceForAccount"),i("WrongDeviceForAccountPayout"),i("WrongDeviceForAccountRefund"),i("WrongAppForCurrency"),i("ETHAddressNonEIP"),i("CantScanQRCode"),i("FeeNotLoaded"),i("FeeNotLoadedSwap"),i("FeeRequired"),i("FeeTooHigh"),i("PendingOperation"),i("SyncError"),i("PairingFailed"),i("PeerRemovedPairing"),i("GenuineCheckFailed"),i("LedgerAPI4xx"),i("LedgerAPI5xx"),i("FirmwareOrAppUpdateRequired"),i("ReplacementTransactionUnderpriced"),i("OpReturnSizeLimit"),i("DustLimit"),i("LanguageNotFound"),i("NoDBPathGiven"),i("DBWrongPassword"),i("DBNotReset"),i("SequenceNumberError"),i("DisabledTransactionBroadcastError"),function(e){e.Unknown="Unknown",e.LocationServicesDisabled="LocationServicesDisabled",e.LocationServicesUnauthorized="LocationServicesUnauthorized",e.BluetoothScanStartFailed="BluetoothScanStartFailed"}(c||(c={})),Error;class d extends Error{constructor(e,t){const n="TransportError";super(e||n),this.name=n,this.message=e,this.stack=new Error(e).stack,this.id=t}}a("TransportError",(e=>new d(e.message,e.id)));const u={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};class E extends Error{constructor(e,{canBeMappedToChildError:t=!0}={}){const n=Object.keys(u).find((t=>u[t]===e))||"UNKNOWN_ERROR",r=`Ledger device: ${function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||n} (0x${e.toString(16)})`;if(super(r),this.name="TransportStatusError",this.statusCode=e,this.statusText=n,Object.setPrototypeOf(this,E.prototype),t&&e===u.LOCKED_DEVICE)return new p(r)}}class p extends E{constructor(e){super(u.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,p.prototype)}}a("TransportStatusError",(e=>new E(e.statusCode)))},34557:(e,t,n)=>{t._t=t.vY=t.vs=void 0;var r=n(80715);Object.defineProperty(t,"vs",{enumerable:!0,get:function(){return r.TonTransport}}),Object.defineProperty(t,"vY",{enumerable:!0,get:function(){return r.parseMessage}}),Object.defineProperty(t,"_t",{enumerable:!0,get:function(){return r.KNOWN_JETTONS}})},38861:(e,t,n)=>{n.d(t,{signTonProofWithLedger:()=>C,signTonTransactionsWithLedger:()=>R});var r=n(24450),o=n(34557),a=n(23174),i=n(3476);function s(e,t,n){return function(e,t){return[44,607,t?1:0,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Zm)===i.li.MasterChain?255:0,e,0]}(t.index,"mainnet"!==e,n)}new Set(["DisconnectedDeviceDuringOperation","TransportRaceCondition"]);var c=n(55029),d=n(13983),u=n(31481),E=n(5370),p=n(48287).Buffer;const l=u.gmk?"hex":"base64";class T extends d.Ay{async exchange(e){const t=await(0,E.p)("exchangeWithLedger",e.toString(l));return p.from(t,l)}}var g=n(88823),N=n(48287).Buffer;const h="2.1",A="2.2",_="2.1",D={unsafe:"2.1",comment:"0","jetton-transfer":"0","nft-transfer":"2.1","jetton-burn":"2.1","add-whitelist":"2.1","single-nominator-withdraw":"2.1","single-nominator-change-validator":"2.1","tonstakers-deposit":"2.1","vote-for-proposal":"2.1","change-dns-record":"2.1","token-bridge-pay-swap":"2.1"},O=Object.fromEntries(o._t.map(((e,t)=>{let{masterAddress:n}=e;return[(0,g.vn)(n,!0,"mainnet"),t]}))),I=new o.vs(new T),f=new Error("Unsupported"),S=new Error("Lacks blind signing");async function C(e,t,n){const r=s(e,t),{timestamp:o,domain:a,payload:i}=n;try{return(await I.getAddressProof(r,{domain:a,timestamp:o,payload:N.from(i)})).signature}catch(e){return v(e)}}async function R(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.PY;const d=s(e,t),u=await I.getVersion(),E=await async function(e){if(!y(e,_))return!0;const{blindSigningEnabled:t}=await I.getSettings();return t}(u);let p;try{p=await Promise.all(n.map((n=>async function(e,t,n,r,o,a){const{authType:s="external",sendMode:c=0,seqno:d,timeout:u,hints:E}=n,p=function(e){let{messages:t}=e;if(0===t.length)throw new Error("No messages");if(t.length>1)throw new Error("Ledger doesn't support signing more than 1 message");return t[0]}(n);if("external"!==s)throw new Error(`Unsupported transaction authType "${s}"`);if("internal"!==p.info.type)throw new Error(`Unsupported message type "${p.info.type}"`);return{to:p.info.dest,sendMode:c,seqno:d,timeout:u??Math.floor(Date.now()/1e3+i.kF),bounce:p.info.bounce,amount:p.info.value.coins,stateInit:p.init??void 0,payload:await w(e,p.info.dest,p.body,r,o,E),walletSpecifiers:m(t,r,a)}}(e,t.version,n,u,E,r))))}catch(e){if(e===f)return{error:a.jc.HardwareOutdated};if(e===S)return{error:a.jc.BlindSigningNotEnabled};throw e}return async function(e,t,n){const r=[];let o=0,a=0;for(;a<t.length;)try{r.push(await I.signTransaction(e,t[a])),a++}catch(e){try{return v(e)}catch{if(o>=n)throw e;o++}(0,c.SJ)("signLedgerTransactionsWithRetry",e)}return r}(d,p,o)}async function w(e,t,n,r,a){let{tokenAddress:s}=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const d=function(e,t){if(!e)return;let n;try{n=(0,o.vY)(e,{disallowModification:!0,disallowUnsafe:!0})}catch(t){(0,c.MD)("Unsafe Ledger payload",t),n={type:"unsafe",message:e}}if(n&&!y(t,D[n.type])){if((0,c.MD)(`The ${n.type} payload type is not supported by Ledger TON v${t}`),!y(t,D.unsafe))throw f;(0,c.MD)("Falling back to an unsafe payload"),n={type:"unsafe",message:e}}return n}(n,r);if("jetton-transfer"===(null==d?void 0:d.type)&&y(r,A)){if(!s){const n=(0,g.vn)(t,!0,e);s=await(0,g.uA)(e,n)}s&&(d.knownJetton=function(e){const t=O[e];return void 0===t?null:{jettonId:t,workchain:i.Zm}}(s))}if("unsafe"===(null==d?void 0:d.type)&&!a)throw S;return d}function y(e,t){return function(e,t){const n=e.split(".").map(Number),r=t.split(".").map(Number);for(let e=0;e<Math.max(n.length,r.length);e++){const t=n[e]||0,o=r[e]||0;if(t>o)return 1;if(t<o)return-1}return 0}(e,t)>=0}function m(e,t,n){if("v3R2"===e){if(!y(t,h))throw f;return{includeWalletOp:!1}}if(void 0!==n){if(!y(t,h))throw f;return{subwalletId:n,includeWalletOp:!1}}}function v(e){if(e instanceof r.TransportStatusError)switch(e.statusCode){case 27013:return{error:a.jc.RejectedByUser};case 48384:return{error:a.jc.BlindSigningNotEnabled};case 45067:return{error:a.jc.ProofTooLarge}}throw e}}}]);
//# sourceMappingURL=76.479f7cdd2b48255d4577.js.map